/* ===== Base ===== */
*{ box-sizing:border-box; }
html, body { height:100%; }
body{
  margin:0;
  color:#eaeaea;
  overflow-x:hidden;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Helvetica Neue", sans-serif;

  background-color:#050505;
  background-image: url("assets/backgrounds/bg.jpg");
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
}

body::before{
  content:"";
  position: fixed;
  inset: 0;
  z-index: 0;
  pointer-events: none;
  background: rgba(0,0,0,0.55);
}

/* ===== Analog flicker overlay (only during transitions) ===== */
body::after{
  content:"";
  position: fixed;
  inset: 0;
  z-index: 9997; /* under textures, over content */
  pointer-events: none;
  opacity: 0;
}

body.fx-flicker::after{
  background:
    radial-gradient(circle at 50% 45%, rgba(255,255,255,0.10), rgba(255,255,255,0) 55%),
    linear-gradient(to bottom, rgba(255,255,255,0.06), rgba(0,0,0,0.02));
  mix-blend-mode: screen;
  animation: analogFlicker 220ms steps(1) 1;
}

body.fx-flicker .frame{
  animation: analogExposure 220ms steps(1) 1;
}

@keyframes analogFlicker{
  0%   { opacity: 0; }
  15%  { opacity: 0.95; }
  30%  { opacity: 0.20; }
  55%  { opacity: 0.70; }
  85%  { opacity: 0.10; }
  100% { opacity: 0; }
}

@keyframes analogExposure{
  0%   { filter: brightness(1) contrast(1); }
  15%  { filter: brightness(1.10) contrast(1.02); }
  30%  { filter: brightness(0.97) contrast(1.03); }
  55%  { filter: brightness(1.06) contrast(1.02); }
  85%  { filter: brightness(0.99) contrast(1.01); }
  100% { filter: brightness(1) contrast(1); }
}

/* ===== Texture Overlays (locked) ===== */
.texture{
  position: fixed;
  inset: 0;
  z-index: 9999;
  pointer-events: none;
  background-position: center;
  background-attachment: fixed;
}

/* Concrete BELOW */
.texture-concrete{
  background-image: url("assets/textures/concrete-texture.png");
  background-size: cover;
  opacity: 0.13;
  mix-blend-mode: plus-lighter;
}
@supports not (mix-blend-mode: plus-lighter){
  .texture-concrete{ mix-blend-mode: color-dodge; }
}

/* Moving Film Grain */
.texture-grain{
  background-image: url("assets/textures/film-grain.png");
  background-repeat: repeat;
  background-size: 420px auto;
  opacity: 0.12;            /* bump this if you want it more visible */
  mix-blend-mode: overlay;
  animation: grainMove 0.9s steps(6) infinite;
  will-change: transform;
}

/* VHS TOP */
.texture-vhs{
  background-image: url("assets/textures/vhs-texture.png");
  background-size: cover;
  opacity: 0.76;
  mix-blend-mode: lighten;
}

@keyframes grainMove{
  0%   { transform: translate3d(0,0,0); }
  15%  { transform: translate3d(-1%, -1%, 0); }
  30%  { transform: translate3d(1%, -2%, 0); }
  45%  { transform: translate3d(-2%, 1%, 0); }
  60%  { transform: translate3d(2%, 2%, 0); }
  75%  { transform: translate3d(-1%, 2%, 0); }
  100% { transform: translate3d(0,0,0); }
}

/* ===== Header ===== */
.hdr{
  position: relative;
  z-index: 50;
  text-align:center;
  padding: 28px 14px 12px;
  background: rgba(0,0,0,0.55);
  border-bottom: 1px solid rgba(255,255,255,0.10);
  transition: padding 320ms ease, transform 320ms ease, background 320ms ease;
}

/* Constant micro jitter on name */
.nameImgBtn{
  all: unset;
  cursor: pointer;
  display: inline-block;
  user-select: none;
  line-height: 0;
  animation: vhsMicroJitter 1.25s steps(2) infinite;
  will-change: transform;
}

.nameImg{
  display:block;
  width:auto;
  height:auto;
  max-height: 140px; /* big on home */
  max-width: min(92vw, 1200px);
  filter: drop-shadow(0 2px 0 rgba(0,0,0,0.65)) drop-shadow(0 16px 40px rgba(0,0,0,0.65));
  transition: max-height 320ms ease, transform 320ms ease, opacity 320ms ease;
}

body:not(.route-home) .hdr{
  padding: 16px 14px 8px;
  transform: translateY(-2px);
  background: rgba(0,0,0,0.62);
}

body:not(.route-home) .nameImg{
  max-height: 60px;
  transform: translateY(4px);
}

@keyframes vhsMicroJitter{
  0%   { transform: translate3d(0,0,0); }
  20%  { transform: translate3d(0.25px, 0, 0); }
  40%  { transform: translate3d(-0.35px, 0.15px, 0); }
  60%  { transform: translate3d(0.30px, -0.10px, 0); }
  80%  { transform: translate3d(-0.20px, 0.05px, 0); }
  100% { transform: translate3d(0,0,0); }
}

/* ===== Layout + Views (same as before, trimmed for brevity) ===== */
.frame{ position: relative; z-index: 5; max-width:1500px; margin:0 auto; padding:10px 14px 22px; }
.system{ display:grid; grid-template-columns:200px minmax(0,1fr) 200px; gap:14px; }
.side{ position:relative; border:1px solid rgba(255,255,255,0.14); background:rgba(0,0,0,0.22); overflow:hidden; }
.sideMask{ position:absolute; inset:-60px; pointer-events:none; z-index:3; background:
  radial-gradient(circle at center, rgba(0,0,0,0) 28%, rgba(0,0,0,0.40) 55%, rgba(0,0,0,0.92) 100%),
  linear-gradient(to right, rgba(0,0,0,0.90), rgba(0,0,0,0) 30%, rgba(0,0,0,0) 70%, rgba(0,0,0,0.90));
  mix-blend-mode:multiply; opacity:.96; }
.sideStack{ display:grid; gap:10px; padding:12px; }
.sideTile{ border:1px solid rgba(255,255,255,0.14); aspect-ratio:4/3; overflow:hidden; }
.sideTile img{ width:100%; height:100%; object-fit:cover; opacity:.75; }

body:not(.route-home) .side{ display:none; }
body:not(.route-home) .system{ grid-template-columns:1fr; }

.center{ position:relative; min-height:620px; }
.view{ position:absolute; inset:0; opacity:0; transform:translateY(8px); pointer-events:none; transition:opacity .32s, transform .32s; }
.view.is-active{ opacity:1; transform:translateY(0); pointer-events:auto; }

.heroClip{ border:1px solid rgba(255,255,255,0.16); aspect-ratio:16/9; overflow:hidden; }
.heroImg{ width:100%; height:100%; object-fit:cover; }

.filmsGrid{ height:100%; display:grid; grid-template-columns:1.2fr 1fr 1fr; grid-template-rows:1fr 1fr; gap:14px; }
.filmsGrid .tile:nth-child(1){ grid-row:1/span 2; grid-column:1; }
.filmsGrid .tile:nth-child(2){ grid-row:1; grid-column:2; }
.filmsGrid .tile:nth-child(3){ grid-row:1; grid-column:3; }
.filmsGrid .tile:nth-child(4){ grid-row:2; grid-column:2; }
.filmsGrid .tile:nth-child(5){ grid-row:2; grid-column:3; }

.tile{ position:relative; border:1px solid rgba(255,255,255,0.16); overflow:hidden; cursor:pointer; }
.tileImg{ width:100%; height:100%; object-fit:cover; transition:.2s; }
.tile:hover .tileImg{ filter:blur(2px); transform:scale(1.04); opacity:.75; }
.tileInfo{ position:absolute; inset:0; display:flex; flex-direction:column; justify-content:center; align-items:center; gap:10px; opacity:0; transition:.2s; }
.tile:hover .tileInfo{ opacity:1; }
.tileLogo{ max-width:72%; max-height:120px; object-fit:contain; }

@media (max-width: 980px){
  .system{ grid-template-columns:1fr; }
  .nameImg{ max-height:96px; }
  body:not(.route-home) .nameImg{ max-height:52px; }
}
